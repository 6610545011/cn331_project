{% extends "core/template.html" %}
{% load static %}

{% block title %}{{ prof.name }} - Thammasat Study Plan{% endblock title %}

{% block extra_head %}
{# ใช้ CSS ไฟล์เดียวกับหน้ารายละเอียดวิชาเพื่อความสอดคล้อง #}
<link rel="stylesheet" href="{% static 'core/css/detail_page.css' %}">
{% endblock extra_head %}

{% block content %}
<div class="detail-container">
    
    {# --- ส่วนหัว: ข้อมูลหลักของอาจารย์ --- #}
    <div class="detail-header">
        <div class="header-content">
            {% if prof.img_url %}
                <img src="{{ prof.img_url }}" alt="Photo of {{ prof.name }}" class="profile-image">
            {% endif %}
            <div class="header-text">
                <h1>{{ prof.name }}</h1>
                <p class="sub-heading">
                    <strong>Campus:</strong> {{ prof.campus.name }} | 
                    <strong>Room:</strong> {{ prof.room.name }}
                </p>
                {% if prof.email %}
                    <p><strong>Email:</strong> <a href="mailto:{{ prof.email }}">{{ prof.email }}</a></p>
                {% endif %}
                {% if prof.website %}
                    <p><strong>Website:</strong> <a href="{{ prof.website }}" target="_blank" rel="noopener noreferrer">{{ prof.website }}</a></p>
                {% endif %}
                <p>{{ prof.description }}</p>
            </div>
        </div>
    </div>

    <div class="detail-content">
        
        {# --- ส่วนที่ 1: รายการ Section ที่สอน --- #}
        <h3>Sections Taught</h3>
        <div class="card-list">
            {% for section in prof.section_set.all %}
                <div class="info-card">
                    <h4>{{ section.course.code }} - {{ section.course.name }}</h4>
                    <p><strong>Section:</strong> {{ section.section_number }}</p>
                </div>
            {% empty %}
                <p>This professor is not currently assigned to any sections.</p>
            {% endfor %}
        </div>

        {# --- ส่วนที่ 2: รายการรีวิว --- #}
        <h3>Reviews</h3>
        <div class="card-list">
            {% for review in prof.review_set.all %}
                <div class="info-card review-card">
                    <h4>{{ review.header }}</h4>
                    <p class="rating">Rating: {{ review.rating }} / 5 ★</p>
                    
                    {% if review.course %}
                        <p><strong>For Course:</strong> {{ review.course.code }} - {{ review.course.name }}</p>
                    {% endif %}

                    <div class="review-body">
                        <p>"{{ review.body }}"</p>
                    </div>

                    <div class="review-meta">
                        <p>
                            By 
                            <strong>
                                {% if review.incognito %}
                                    Anonymous
                                {% else %}
                                    {{ review.user.username }}
                                {% endif %}
                            </strong> 
                            on {{ review.created_at|date:"F j, Y" }}
                        </p>
                    </div>
                </div>
            {% empty %}
                <p>No reviews available for this professor yet.</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock content %}